trigger:
- main

pool:
  name: Default

variables:
  project-name-dev: 'ado-openshift'
  project-name-uat: 'ado-openshift'
  image-name: 'wk-dotnet'

stages:
- stage: Build
  displayName: Build and Push Image
  jobs:
  - job: BuildAndPushJob
    displayName: Build and Push Job
    steps:
    - script: dotnet build "app/DotNet.Podman.csproj" -c Release -o podman/app/build
      displayName: 'dotnet build'

    - script: dotnet publish "app/DotNet.Podman.csproj" -c Release -o podman/app/publish
      displayName: 'dotnet publish'

    - script: podman build -t dotnet-counter-app:$(Build.BuildId) -f podman/app/Containerfile && podman images 
      displayName: 'podman build'

    - script: oc project
      displayName: 'oc'
